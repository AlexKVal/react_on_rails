sudo: required

language: ruby

rvm:
  - 2.3.1

services:
  - docker

cache: bundler

gemfile:
  - spec/dummy/Gemfile

bundler_args: "--without development production --quiet"

env:
  - export RAILS_ENV=test DRIVER=selenium_chrome

before_install:
  - sudo apt-get update
  - sudo apt-get install -y xvfb libappindicator1 fonts-liberation
  - wget https://dl.google.com/linux/direct/google-chrome-stable_current_amd64.deb
  - sudo dpkg -i google-chrome*.deb

install:
  - rm -rf ~/.nvm && git clone https://github.com/creationix/nvm.git ~/.nvm && (cd ~/.nvm && git checkout `git describe --abbrev=0 --tags`) && source ~/.nvm/nvm.sh && nvm install 5.10.0
  - npm install -g npm
  - "phantomjs --version"
  - "npm install phantomjs-prebuilt"
  - "phantomjs --version"
  - gem install bundler
  - bundle install
  - ENABLE_TURBOLINKS_5=TRUE bundle install
  - npm install
  - rake dummy_apps
  - rake examples
  - rake node_package

before_script:
  - "export DISPLAY=:99"
  - Xvfb :99 -ac -screen scn 1600x1200x16 &

script:
  - rake
